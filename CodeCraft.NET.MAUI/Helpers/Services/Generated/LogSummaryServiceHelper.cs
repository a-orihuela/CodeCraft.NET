// <auto-generated>
//     This code was generated by CodeCraft.NET Generator.
//     Manual changes to this file may be overwritten.
// </auto-generated>

using System.Collections.ObjectModel;
using System.ComponentModel;
using CommunityToolkit.Mvvm.ComponentModel;
using Microsoft.Extensions.Logging;
using CodeCraft.NET.Application.DTOs.LogSummaries;
using CodeCraft.NET.Application.CQRS.Features.LogSummaries.Commands.Create;
using CodeCraft.NET.Application.CQRS.Features.LogSummaries.Commands.Update;
using CodeCraft.NET.Services.Services;
using CodeCraft.NET.MAUI.Services.Generated;

namespace CodeCraft.NET.MAUI.Helpers.Services.Generated
{
    /// <summary>
    /// Service helper for LogSummary operations optimized for MAUI UI
    /// Provides loading states, error handling, and UI-friendly methods
    /// </summary>
    public partial class LogSummaryServiceHelper
    {
        private readonly LogSummaryService _service;
        private readonly ILogger<LogSummaryServiceHelper> _logger;

        public LogSummaryServiceHelper(LogSummaryService service, ILogger<LogSummaryServiceHelper> logger)
        {
            _service = service;
            _logger = logger;
        }

        /// <summary>
        /// Load all LogSummaries with UI loading states
        /// </summary>
        public async Task<MauiServiceResult<ObservableCollection<LogSummaryDto>>> LoadAllForUIAsync(
            INotifyPropertyChanged viewModel = null)
        {
            try
            {
                _logger.LogInformation("Loading all LogSummaries for UI");
                
                // Set loading state if ViewModel supports it
                SetLoadingState(viewModel, true);
                
                var result = await _service.GetAllAsync();
                
                if (result.IsSuccess)
                {
                    var collection = new ObservableCollection<LogSummaryDto>(result.Data);
                    _logger.LogInformation("Successfully loaded {Count} LogSummaries", collection.Count);
                    return MauiServiceResult<ObservableCollection<LogSummaryDto>>.Success(collection);
                }
                else
                {
                    _logger.LogWarning("Failed to load LogSummaries: {Error}", result.ErrorMessage);
                    return MauiServiceResult<ObservableCollection<LogSummaryDto>>.Failure(
                        result.ErrorMessage, 
                        "Failed to load LogSummaries. Please check your connection and try again.");
                }
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "Exception while loading LogSummaries for UI");
                return MauiServiceResult<ObservableCollection<LogSummaryDto>>.Failure(
                    ex.Message,
                    "An unexpected error occurred while loading LogSummaries.");
            }
            finally
            {
                SetLoadingState(viewModel, false);
            }
        }

        /// <summary>
        /// Create LogSummary with UI validation and feedback
        /// </summary>
        public async Task<MauiServiceResult<int>> CreateWithUIFeedbackAsync(
            LogSummaryCreate command,
            INotifyPropertyChanged viewModel = null)
        {
            try
            {
                _logger.LogInformation("Creating LogSummary via UI");
                
                SetSavingState(viewModel, true);
                
                var result = await _service.CreateAsync(command);
                
                if (result.IsSuccess)
                {
                    _logger.LogInformation("Successfully created LogSummary with ID: {Id}", result.Data);
                    return MauiServiceResult<int>.Success(
                        result.Data,
                        "LogSummary created successfully!");
                }
                else
                {
                    _logger.LogWarning("Failed to create LogSummary: {Error}", result.ErrorMessage);
                    return MauiServiceResult<int>.Failure(
                        result.ErrorMessage,
                        "Failed to create LogSummary. Please check your input and try again.");
                }
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "Exception while creating LogSummary via UI");
                return MauiServiceResult<int>.Failure(
                    ex.Message,
                    "An unexpected error occurred while creating the LogSummary.");
            }
            finally
            {
                SetSavingState(viewModel, false);
            }
        }

        /// <summary>
        /// Update LogSummary with optimistic UI updates
        /// </summary>
        public async Task<MauiServiceResult<bool>> UpdateWithUIFeedbackAsync(
            LogSummaryUpdate command,
            INotifyPropertyChanged viewModel = null)
        {
            try
            {
                _logger.LogInformation("Updating LogSummary {Id} via UI", command.Id);
                
                SetSavingState(viewModel, true);
                
                var result = await _service.UpdateAsync(command);
                
                if (result.IsSuccess)
                {
                    _logger.LogInformation("Successfully updated LogSummary {Id}", command.Id);
                    return MauiServiceResult<bool>.Success(
                        true,
                        "LogSummary updated successfully!");
                }
                else
                {
                    _logger.LogWarning("Failed to update LogSummary {Id}: {Error}", command.Id, result.ErrorMessage);
                    return MauiServiceResult<bool>.Failure(
                        result.ErrorMessage,
                        "Failed to update LogSummary. Please check your input and try again.");
                }
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "Exception while updating LogSummary {Id} via UI", command.Id);
                return MauiServiceResult<bool>.Failure(
                    ex.Message,
                    "An unexpected error occurred while updating the LogSummary.");
            }
            finally
            {
                SetSavingState(viewModel, false);
            }
        }

        /// <summary>
        /// Delete LogSummary with confirmation handling
        /// </summary>
        public async Task<MauiServiceResult<bool>> DeleteWithConfirmationAsync(
            int id,
            INotifyPropertyChanged viewModel = null)
        {
            try
            {
                _logger.LogInformation("Deleting LogSummary {Id} via UI", id);
                
                SetLoadingState(viewModel, true);
                
                var result = await _service.DeleteAsync(id);
                
                if (result.IsSuccess)
                {
                    _logger.LogInformation("Successfully deleted LogSummary {Id}", id);
                    return MauiServiceResult<bool>.Success(
                        true,
                        "LogSummary deleted successfully!");
                }
                else
                {
                    _logger.LogWarning("Failed to delete LogSummary {Id}: {Error}", id, result.ErrorMessage);
                    return MauiServiceResult<bool>.Failure(
                        result.ErrorMessage,
                        "Failed to delete LogSummary. It may have been already removed.");
                }
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "Exception while deleting LogSummary {Id} via UI", id);
                return MauiServiceResult<bool>.Failure(
                    ex.Message,
                    "An unexpected error occurred while deleting the LogSummary.");
            }
            finally
            {
                SetLoadingState(viewModel, false);
            }
        }

        /// <summary>
        /// Get LogSummary by ID with UI error handling
        /// </summary>
        public async Task<MauiServiceResult<LogSummaryDto>> GetByIdForUIAsync(
            int id,
            INotifyPropertyChanged viewModel = null)
        {
            try
            {
                _logger.LogInformation("Loading LogSummary {Id} for UI", id);
                
                SetLoadingState(viewModel, true);
                
                var result = await _service.GetByIdAsync(id);
                
                if (result.IsSuccess && result.Data != null)
                {
                    _logger.LogInformation("Successfully loaded LogSummary {Id}", id);
                    return MauiServiceResult<LogSummaryDto>.Success(result.Data);
                }
                else
                {
                    _logger.LogWarning("LogSummary {Id} not found", id);
                    return MauiServiceResult<LogSummaryDto>.Failure(
                        "Entity not found",
                        "The requested LogSummary could not be found.");
                }
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "Exception while loading LogSummary {Id} for UI", id);
                return MauiServiceResult<LogSummaryDto>.Failure(
                    ex.Message,
                    "An unexpected error occurred while loading the LogSummary.");
            }
            finally
            {
                SetLoadingState(viewModel, false);
            }
        }

        #region Private Helper Methods

        private void SetLoadingState(INotifyPropertyChanged viewModel, bool isLoading)
        {
            if (viewModel is ObservableObject observable)
            {
                // Try to set IsLoading property if it exists
                var isLoadingProperty = observable.GetType().GetProperty("IsLoading");
                isLoadingProperty?.SetValue(observable, isLoading);
            }
        }

        private void SetSavingState(INotifyPropertyChanged viewModel, bool isSaving)
        {
            if (viewModel is ObservableObject observable)
            {
                // Try to set IsSaving property if it exists
                var isSavingProperty = observable.GetType().GetProperty("IsSaving");
                isSavingProperty?.SetValue(observable, isSaving);
            }
        }

        #endregion
    }
}